<!DOCTYPE html>
   <html lang="es">
   <head>
       <meta charset="UTF-8">
       <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.gstatic.com https://accounts.google.com https://apis.google.com;">
       <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <title>Sistema de Gestión de Casas</title>
       <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
       <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
       <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
       <script src="https://apis.google.com/js/api.js"></script>
       <script src="renderer.js" defer></script>
       <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
       <link rel="icon" href="data:,">
   </head>
   <body class="bg-gray-100 font-sans">
       <header class="bg-blue-600 text-white p-4">
           <h1 class="text-2xl font-bold">Sistema de Gestión de Casas</h1>
           <p class="text-sm">Control de casas, gastos e ingresos</p>
           <p class="text-sm">Último acceso: 04:15 PM -05, Lunes 2 de Junio de 2025</p>
           <div class="mt-2 space-x-2">
               <button id="newHouseBtn" class="bg-green-500 hover:bg-green-600 text-white p-2 rounded">Nueva Casa</button>
               <button id="backupBtn" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded">Backup</button>
               <button id="importBtn" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded">Importar Backup</button>
               <input type="file" id="importBackup" class="hidden" accept=".json">
               <button id="exportExcelBtn" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded">Exportar Gastos a Excel</button>
               <button id="syncGoogleDrive" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded">Sincronizar con Google Drive</button>
           </div>
       </header>

       <nav class="bg-gray-800 text-white p-4">
           <button data-section="dashboard" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded mx-1">Dashboard</button>
           <button data-section="gastos" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded mx-1">Gastos</button>
           <button data-section="ingresos" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded mx-1">Ingresos</button>
           <button data-section="reportes" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded mx-1">Reportes</button>
       </nav>

       <main class="p-4">
           <section id="dashboard" class="space-y-6">
               <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                   <div class="bg-white p-4 rounded shadow">
                       <p class="text-lg font-medium">Total Casas</p>
                       <p id="totalHouses" class="text-2xl font-bold">0</p>
                   </div>
                   <div class="bg-white p-4 rounded shadow">
                       <p class="text-lg font-medium">Total Ingresos</p>
                       <p id="totalIncomes" class="text-2xl font-bold">$0</p>
                   </div>
                   <div class="bg-white p-4 rounded shadow">
                       <p class="text-lg font-medium">Total Gastos</p>
                       <p id="totalExpenses" class="text-2xl font-bold">$0</p>
                   </div>
                   <div class="bg-white p-4 rounded shadow">
                       <p class="text-lg font-medium">Saldo</p>
                       <p id="totalBalance" class="text-2xl font-bold">$0</p>
                   </div>
               </div>

               <h2 class="text-xl font-semibold">Casas Registradas</h2>
               <table class="w-full text-left border-collapse">
                   <thead>
                       <tr class="bg-gray-200">
                           <th class="p-3">Casa</th>
                           <th class="p-3">Gastos</th>
                           <th class="p-3">Acciones</th>
                       </tr>
                   </thead>
                   <tbody id="housesList"></tbody>
               </table>
               <p class="mt-2 text-sm text-gray-600">Haz clic en una casa para ver el detallado de gastos.</p>

               <div id="houseExpensesDetail" class="hidden mt-4">
                   <h3 id="houseExpensesTitle" class="text-xl font-semibold mb-4">Detallado de Gastos</h3>
                   <table class="w-full text-left border-collapse">
                       <thead>
                           <tr class="bg-gray-200">
                               <th class="p-3">Fecha</th>
                               <th class="p-3">Descripción</th>
                               <th class="p-3">Valor</th>
                           </tr>
                       </thead>
                       <tbody id="houseExpensesList"></tbody>
                   </table>
                   <p id="houseExpensesTotal" class="mt-4 text-lg font-medium">Total Gastos: $0</p>
                   <div class="mt-2 space-x-2">
                       <button id="exportDetailPdf" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded">Exportar a PDF</button>
                       <button id="exportDetailExcel" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded">Exportar a Excel</button>
                   </div>
               </div>
           </section>

           <section id="gastos" class="hidden space-y-6">
               <h2 class="text-xl font-semibold">Registro de Gastos</h2>
               <div class="bg-white p-4 rounded shadow space-y-4">
                   <div>
                       <label for="expenseDescription" class="block text-sm font-medium">Descripción</label>
                       <input id="expenseDescription" type="text" class="w-full p-2 border rounded">
                   </div>
                   <div>
                       <label for="expenseAmount" class="block text-sm font-medium">Valor Total</label>
                       <input id="expenseAmount" type="text" class="w-full p-2 border rounded" data-value="0" oninput="formatInput(this)">
                   </div>
                   <div>
                       <label for="expenseDate" class="block text-sm font-medium">Fecha</label>
                       <input id="expenseDate" type="date" class="w-full p-2 border rounded" value="2025-06-02">
                   </div>
                   <div class="flex items-center">
                       <input id="sharedExpense" type="checkbox" class="mr-2">
                       <label for="sharedExpense" class="text-sm font-medium">Gasto compartido entre varias casas</label>
                   </div>
                   <div id="houseAssignment">
                       <label for="expenseHouse" class="block text-sm font-medium">Asignar a Casa</label>
                       <select id="expenseHouse" class="w-full p-2 border rounded">
                           <option value="">Seleccione una casa</option>
                       </select>
                   </div>
                   <div id="sharedHouseAssignments" class="hidden">
                       <p class="text-sm font-medium">Distribución por Casa</p>
                       <div id="sharedHousesList" class="space-y-2"></div>
                   </div>
                   <button id="registerExpense" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded">Registrar Gasto</button>
               </div>

               <h2 class="text-xl font-semibold">Gastos Registrados</h2>
               <div class="mb-4">
                   <select id="filterHouses" class="p-2 border rounded">
                       <option value="all">Todas las casas</option>
                   </select>
               </div>
               <table class="w-full text-left border-collapse">
                   <thead>
                       <tr class="bg-gray-200">
                           <th class="p-3">Fecha</th>
                           <th class="p-3">Descripción</th>
                           <th class="p-3">Casa</th>
                           <th class="p-3">Valor</th>
                           <th class="p-3">Acciones</th>
                       </tr>
                   </thead>
                   <tbody id="expensesList"></tbody>
               </table>
           </section>

           <section id="ingresos" class="hidden space-y-6">
               <h2 class="text-xl font-semibold">Registro de Ingresos</h2>
               <div class="bg-white p-4 rounded shadow space-y-4">
                   <div>
                       <label for="incomeDescription" class="block text-sm font-medium">Descripción</label>
                       <input id="incomeDescription" type="text" class="w-full p-2 border rounded">
                   </div>
                   <div>
                       <label for="incomeAmount" class="block text-sm font-medium">Valor</label>
                       <input id="incomeAmount" type="text" class="w-full p-2 border rounded" data-value="0" oninput="formatInput(this)">
                   </div>
                   <div>
                       <label for="incomeDate" class="block text-sm font-medium">Fecha</label>
                       <input id="incomeDate" type="date" class="w-full p-2 border rounded" value="2025-06-02">
                   </div>
                   <button id="registerIncome" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded">Registrar Ingreso</button>
               </div>

               <h2 class="text-xl font-semibold">Ingresos Registrados</h2>
               <table class="w-full text-left border-collapse">
                   <thead>
                       <tr class="bg-gray-200">
                           <th class="p-3">Fecha</th>
                           <th class="p-3">Descripción</th>
                           <th class="p-3">Valor</th>
                           <th class="p-3">Acciones</th>
                       </tr>
                   </thead>
                   <tbody id="incomesList"></tbody>
               </table>
           </section>

           <section id="reportes" class="hidden space-y-6">
               <h2 class="text-xl font-semibold">Reportes</h2>
               <div class="space-y-4">
                   <div class="bg-white p-4 rounded shadow">
                       <h3 class="text-lg font-medium">Reporte por Casa</h3>
                       <div class="mt-2">
                           <label for="reportHouse" class="block text-sm font-medium">Seleccionar Casa</label>
                           <select id="reportHouse" class="w-full p-2 border rounded">
                               <option value="">Seleccione una casa</option>
                           </select>
                           <button id="generateHouseReport" class="mt-2 bg-blue-500 hover:bg-blue-600 text-white p-2 rounded">Generar Reporte</button>
                       </div>
                   </div>

                   <div class="bg-white p-4 rounded shadow">
                       <h3 class="text-lg font-medium">Reporte Consolidado</h3>
                       <div class="mt-2 space-y-2">
                           <label class="block text-sm font-medium">Período</label>
                           <input id="consolidatedStartDate" type="date" class="p-2 border rounded" value="2025-01-01">
                           <input id="consolidatedEndDate" type="date" class="p-2 border rounded" value="2025-06-02">
                           <button id="generateConsolidatedReport" class="mt-2 bg-blue-500 hover:bg-blue-600 text-white p-2 rounded">Generar Reporte</button>
                       </div>
                   </div>

                   <div class="bg-white p-4 rounded shadow">
                       <h3 class="text-lg font-medium">Reporte Detallado de Ingresos</h3>
                       <div class="mt-2 space-y-2">
                           <label class="block text-sm font-medium">Período</label>
                           <input id="incomeStartDate" type="date" class="p-2 border rounded" value="2025-01-01">
                           <input id="incomeEndDate" type="date" class="p-2 border rounded" value="2025-06-02">
                           <button id="generateIncomeReport" class="mt-2 bg-blue-500 hover:bg-blue-600 text-white p-2 rounded">Generar Reporte</button>
                       </div>
                   </div>

                   <div id="reportContent" class="bg-white p-4 rounded shadow"></div>
                   <button id="exportPdf" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded">Exportar a PDF</button>
               </div>
           </section>

           <div id="editModal" class="fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center hidden">
               <div class="bg-white p-6 rounded shadow-lg w-full max-w-md">
                   <h2 id="editModalTitle" class="text-xl font-semibold mb-4">Editar Transacción</h2>
                   <div class="space-y-4">
                       <div>
                           <label for="editDescription" class="block text-sm font-medium">Descripción</label>
                           <input id="editDescription" type="text" class="w-full p-2 border rounded">
                       </div>
                       <div>
                           <label for="editAmount" class="block text-sm font-medium">Valor</label>
                           <input id="editAmount" type="text" class="w-full p-2 border rounded" data-value="0" oninput="formatInput(this)">
                       </div>
                       <div>
                           <label for="editDate" class="block text-sm font-medium">Fecha</label>
                           <input id="editDate" type="date" class="w-full p-2 border rounded" value="2025-06-02">
                       </div>
                       <div id="editHouseSection">
                           <label for="editHouse" class="block text-sm font-medium">Asignar a Casa</label>
                           <select id="editHouse" class="w-full p-2 border rounded">
                               <option value="">Seleccione una casa</option>
                           </select>
                       </div>
                       <div class="flex justify-end space-x-2">
                           <button id="cancelEdit" class="bg-gray-500 hover:bg-gray-600 text-white p-2 rounded">Cancelar</button>
                           <button id="saveEdit" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded">Guardar</button>
                       </div>
                   </div>
               </div>
           </div>
       </main>
   </body>
   </html>